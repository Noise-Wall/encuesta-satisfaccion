import{_ as E}from"./_plugin-vue_export-helper-c27b6911.js";import{o as r,c as l,a as e,p as y,b as x,u as $,r as _,d as z,F as b,e as C,t as D,f as B,g}from"./index-2e079f12.js";import{g as f}from"./get-f30a68b2.js";import{i as h}from"./insert-9269597b.js";import{p as T}from"./popup-cfc4d190.js";import"./token-3b81b8e9.js";const v=a=>(y("data-v-689dfde8"),a=a(),x(),a),j={id:"info"},F=v(()=>e("h3",null,"Encuesta de Satisfacción al Cliente",-1)),N=v(()=>e("p",null," Estimado cliente, nos dirigimos a usted para solicitarle la realización del siguiente cuestionario con el propósito de ajustarnos mejor a sus necesidades. Su opinión es de gran importancia para nosotros. ",-1)),O=v(()=>e("p",null," A continuación se suministrará una serie de preguntas con el propósito de mejorar nuestra calidad de servicio, favor de marcar la opción que corresponda a su opinión. ",-1)),V={__name:"encuestaInfo",props:{comenzar:Function},setup(a){return(p,u)=>(r(),l("section",j,[F,N,O,e("button",{class:"boton",onClick:u[0]||(u[0]=(...d)=>a.comenzar&&a.comenzar(...d))},"Comenzar encuesta")]))}},A=E(V,[["__scopeId","data-v-689dfde8"]]);const i=a=>(y("data-v-349592c3"),a=a(),x(),a),M={key:0},P=i(()=>e("legend",null,"Busque aquí su empresa",-1)),H=["disabled"],L={id:"buscar"},R=["value"],Y={key:1},G=i(()=>e("div",{class:"cargando"},null,-1)),J=i(()=>e("p",{style:{"text-align":"center"}}," Cargando búsqueda de empresas existentes... ",-1)),K=[G,J],Q={key:2},U=i(()=>e("p",{style:{"text-align":"center"}},null,-1)),W=[U],X=i(()=>e("legend",null,"O llene el siguiente formulario:",-1)),Z={class:"form",id:"form"},ee=i(()=>e("label",{for:"nombreEmpresa",class:"form-item"}," Nombre de la empresa: ",-1)),te=["value","disabled"],se=i(()=>e("label",{for:"correo",class:"form-item"},"Correo electrónico:",-1)),ae=["value","disabled"],oe=i(()=>e("label",{for:"correo",class:"form-item"},"Nombre del contacto:",-1)),ne=["value","disabled"],re={__name:"encuestaDatos",setup(a){const p=$(),u=_(!1);z(()=>setTimeout(()=>u.value=!0,3e3));const d=_({}),s=_([""]);k();async function k(){d.value=await f.getTabla("/empresas").catch(c=>console.log(c.message))}function q(c){s.value=Object.values(d.value.Empresa).filter(t=>t.nombreEmpresa==c.target.value),s.value.length<1&&(s.value=[""])}function w(c){s.value=[""],document.getElementById("buscador").value=""}async function I(c){c.preventDefault();let t,o=!1;if(document.querySelectorAll(".formEmpresa").forEach(m=>o=m.value.trim()==""||o),o){T.createPopup("Debe llenar todos los campos.");return}if(s.value[0]==""){const m=Object.fromEntries(new FormData(document.querySelector("#form")).entries());await h.insertTabla("/Empresas",m).then(n=>{console.log(n),console.log("insertado")}).catch(n=>{console.log(n.message)}),await f.getTabla("/latest/empresa").then(()=>{t=Object.values(temp)[0].idEmpresa}).catch(n=>{console.log(n.message)})}else t=s.value[0].idEmpresa;await S(t)}async function S(c){const t=new Date,m={idEncuesta:(await f.getTabla("/latest/encuesta").catch(n=>console.log(n.message)))[0].idEncuesta+1,idEmpresa:c,fecha:`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`,comentarios:""};await h.insertTabla("/encuestas",m).then(n=>{console.log(n),console.log("nueva encuesta creada"),console.log("ruteando a encuesta..."),p.push(`/encuesta/${m.idEncuesta}`)}).catch(n=>console.log(n.message))}return(c,t)=>(r(),l(b,null,[d.value.Empresa?(r(),l("fieldset",M,[P,e("form",{class:"form",onSubmit:t[0]||(t[0]=o=>o.preventDefault())},[e("input",{type:"text",placeholder:"Escriba aqui para buscar...",id:"buscador",list:"buscar",onInput:q,disabled:s.value[0]!==""},null,40,H),e("datalist",L,[(r(!0),l(b,null,C(d.value.Empresa,o=>(r(),l("option",{value:o.nombreEmpresa},D(o.nombreEmpresa),9,R))),256))])],32),s.value[0]!==""?(r(),l("button",{key:0,class:"boton boton-eliminar",onClick:t[1]||(t[1]=o=>w())}," Borrar resultado ")):B("",!0)])):u.value?(r(),l("div",Q,W)):(r(),l("div",Y,K)),e("fieldset",null,[X,e("form",Z,[ee,e("input",{type:"text",name:"nombreEmpresa",value:s.value[0].nombreEmpresa,class:"form-item formEmpresa",disabled:s.value[0]!=="",required:""},null,8,te),se,e("input",{type:"text",name:"correo",value:s.value[0].correo,class:"form-item formEmpresa",disabled:s.value[0]!=="",required:""},null,8,ae),oe,e("input",{type:"text",name:"nombreContacto",value:s.value[0].nombreContacto,class:"form-item formEmpresa",disabled:s.value[0]!=="",required:""},null,8,ne),e("button",{class:"boton",onClick:t[2]||(t[2]=o=>I(o))}," Proceder a las preguntas ")])])],64))}},ce=E(re,[["__scopeId","data-v-349592c3"]]),_e={__name:"HomeView",setup(a){const p=_(!1);function u(){console.log("comenzar"),p.value=!0}return(d,s)=>p.value?(r(),g(ce,{key:1})):(r(),g(A,{key:0,comenzar:u}))}};export{_e as default};
